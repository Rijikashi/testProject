<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
	<meta charset="utf-8">
	<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
	<link rel="stylesheet" type="text/css" href="taskpane.css">
	<title> Escalation Email </title>
</head>

<body>
	<div id="header-bar" class="d-flex flex-row align-items-center">
			<img id="uni-logo" src="/assets/icon-80.png">

			<h2 class="display-4 ml-5 mb-0" id="header-title">Escalation Emails</h2>
	</div>

	<div class="container" id='create-email-form'>
		<div class="card card-primary">
			<div class="card-header">Escalation Email</div>
			<div class="card-body">
				<form id="escalation-email-form">
					<div class="form-group">
						<label for="name-search">Customer Name</label>
						<input type="text" id="name-search" data-bind="ko_autocomplete: getAutoCompleteObj"
							placeholder="Search customer..." class="form-control" />
					</div>
					<div class="form-group">
						<label for="email-template-list">Customer Template</label>
						<select class="form-control" id="email-template-list" data-bind="options: emailTemplates,
						optionsText: 'name',
						value: selectedTemplate,
						optionsCaption: 'Choose template...'">
						</select>
					</div>
				</form>
			</div>
		</div>
	</div>
	

	<!-- template form modal -->
	<div class="modal fade" id="template-form-modal" tabindex="-1" role="dialog">
		<div class="modal-dialog modal-xl" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title">Email Values</h4>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
							aria-hidden="true">&times;</span></button>
				</div>
				<!-- Form template -->
				<div class="modal-body">
					<form id="template-vars-form">
						<div id="template-form-body"></div>
						<hr>
						<button type="submit" class="btn float-right btn-sm btn-primary" id="apply-template-vars-btn">Save</button>
					</form>
				</div>
			</div>
		</div>
	</div>

	<!-- Result Email -->
	<div class="container email-elements-container" data-bind="visible: templateFormSubmitted" style="display: none">
		<div id="result-email" class="card card-primary">
			<p><strong>Subject: </strong><span id="result-email-subject"></span></p>
			<p><strong>Body: </strong></p>
			<div id="result-email-body">
			</div>
		</div>
	</div>
	<div class="container email-elements-container" data-bind="visible: templateFormSubmitted" style="display: none">
		<div id="email-btn-container" class="float-right">
			<button class="btn btn-sm btn-outline-secondary" id="edit-template-form-btn" type="button">Edit</button>
			<a id="mail-to-btn"><button class="btn btn-primary btn-sm">Send Escalation Email</button></a>
		</div>
	</div>
	<!-- <script src="taskpane.bundle.js"></script> -->
</body>

</html>
